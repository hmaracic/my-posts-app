(this.webpackJsonptest1=this.webpackJsonptest1||[]).push([[0],{32:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),o=n.n(a),c=n(23),i=n.n(c),s=(n(32),n(15)),u=n(16),d=n(4),l=n(3),p=n(6),m=o.a.createContext({propsMessage:"Default logging message:"}),h=function(e){var t=e.componentName,n=e.children;return Object(r.jsx)(m.Consumer,{children:function(e){return console.log("".concat(e.propsMessage," ").concat(t)),n()}})},j=function(e){var t=e.children,n=e.propsMessage;return Object(r.jsx)(m.Provider,{value:{propsMessage:n},children:t})},f=function(e,t){return function(n){return Object(r.jsx)(h,{componentName:t,children:function(){return Object(r.jsx)(e,Object(l.a)({},n))}})}},b=(n(35),f((function(e){var t=e.comment,n=Object(p.a)(e,["comment"]);return Object(r.jsxs)("div",Object(l.a)(Object(l.a)({className:"comment"},n),{},{children:[Object(r.jsxs)("div",{className:"name",children:[Object(r.jsx)("span",{className:"label",children:"Name:"}),t.name]}),Object(r.jsxs)("div",{className:"email",children:[Object(r.jsx)("span",{className:"label",children:"Email:"}),t.email]}),Object(r.jsxs)("div",{className:"body",children:[Object(r.jsx)("span",{className:"label",children:"Body:"}),t.body]})]}))}),"Comment")),O=(n(36),f((function(e){var t,n=e.post,a=Object(p.a)(e,["post"]);return Object(r.jsxs)("div",Object(l.a)(Object(l.a)({className:"post"},a),{},{children:[Object(r.jsxs)("div",{className:"title",children:[Object(r.jsx)("span",{className:"label",children:"Title:"}),n.title]}),Object(r.jsxs)("div",{className:"name",children:[Object(r.jsx)("span",{className:"label",children:"Name:"}),null===(t=n.user)||void 0===t?void 0:t.name]}),Object(r.jsxs)("div",{className:"body",children:[Object(r.jsx)("span",{className:"label",children:"Body:"}),n.body]})]}))}),"Post")),v=(n(37),Object(a.memo)((function(e){var t=e.comments,n=Object(p.a)(e,["comments"]);return Object(r.jsx)("div",Object(l.a)(Object(l.a)({className:"comments-container"},n),{},{children:t.map((function(e){return Object(r.jsx)(b,{comment:e},e.id)}))}))}))),y=f((function(e){var t,n=e.post,a=Object(p.a)(e,["post"]);return Object(r.jsxs)("div",Object(l.a)(Object(l.a)({className:"post-comments-ctr"},a),{},{children:[Object(r.jsx)(O,{post:n}),null!==(t=n.comments&&Object(r.jsx)(v,{comments:n.comments}))&&void 0!==t?t:""]}))}),"PostWithComments"),x=f((function(e){var t,n,a=e.post,o=Object(p.a)(e,["post"]);return Object(r.jsxs)("div",Object(l.a)(Object(l.a)({className:"post-page"},o),{},{children:[Object(r.jsxs)(s.a,{children:[Object(r.jsx)("title",{children:"".concat(a.title.split(" ").map((function(e){return e.length>1?e[0].toUpperCase()+e.substr(1):0===e.length?e:e.toUpperCase()})).join(" ")," - ").concat(null!==(t=null===(n=a.user)||void 0===n?void 0:n.name)&&void 0!==t?t:""," - My Posts")}),Object(r.jsx)("meta",{name:"description",content:"List of all posts with comments"})]}),Object(r.jsx)(y,{post:a})]}))}),"PostPage"),w=n(10),T=n(11),g=n(13),N=n(12),I=(n(38),f(function(e){Object(g.a)(n,e);var t=Object(N.a)(n);function n(e){var r;return Object(w.a)(this,n),(r=t.call(this,e)).updateTimeout=void 0,r.updateSearchTerm=void 0,r.state={searchTerm:r.props.searchTerm},r.updateSearchTerm=function(e){var t=e.target.value;r.setState({searchTerm:t}),null!=r.updateTimeout&&clearTimeout(r.updateTimeout),r.updateTimeout=setTimeout((function(){r.props.updateSearchTerm(t),delete r.updateTimeout}),500)},r}return Object(T.a)(n,[{key:"render",value:function(){var e=this.state.searchTerm,t=this.props,n=(t.searchTerm,t.updateSearchTerm,Object(p.a)(t,["searchTerm","updateSearchTerm"]));return Object(r.jsxs)("div",Object(l.a)(Object(l.a)({className:"search-bar"},n),{},{children:[Object(r.jsx)("span",{className:"label",children:"Search by author name:"}),Object(r.jsx)("input",{name:"search-term-input",type:"text",value:e,onChange:this.updateSearchTerm})]}))}}]),n}(o.a.Component),"SearchBar")),S=o.a.createContext({searchTerm:"",initialSearchTerm:"",updateSearchTerm:function(e){}}),P=function(e){return Object(r.jsx)(S.Consumer,{children:function(t){return Object(a.createElement)(I,Object(l.a)(Object(l.a)({},e),{},{key:t.initialSearchTerm,searchTerm:t.searchTerm,updateSearchTerm:t.updateSearchTerm}))}})},E=function(e){Object(g.a)(n,e);var t=Object(N.a)(n);function n(e){var r,a;return Object(w.a)(this,n),(a=t.call(this,e)).state={searchTerm:null!==(r=e.initialSeachTerm)&&void 0!==r?r:"",updateSearchTerm:function(e){a.setState({searchTerm:e})}},a}return Object(T.a)(n,[{key:"render",value:function(){var e;return Object(r.jsx)(S.Provider,{value:Object(l.a)(Object(l.a)({},this.state),{},{initialSearchTerm:null!==(e=this.props.initialSeachTerm)&&void 0!==e?e:""}),children:this.props.children})}}]),n}(o.a.Component);E.SearchBar=P;var C=f(E,"SearchContainer"),k=function(e){return function(t){Object(g.a)(a,t);var n=Object(N.a)(a);function a(){return Object(w.a)(this,a),n.apply(this,arguments)}return Object(T.a)(a,[{key:"render",value:function(){var t=this;return Object(r.jsx)(S.Consumer,{children:function(n){return Object(r.jsx)(e,Object(l.a)(Object(l.a)({},t.props),{},{searchTerm:n.searchTerm}))}})}}]),a}(o.a.Component)},D=(n(39),f(k(function(e){Object(g.a)(n,e);var t=Object(N.a)(n);function n(){return Object(w.a)(this,n),t.apply(this,arguments)}return Object(T.a)(n,[{key:"render",value:function(){var e=this.props,t=e.posts,n=e.searchTerm,a=Object(p.a)(e,["posts","searchTerm"]),o=n.toLowerCase();return Object(r.jsxs)("div",Object(l.a)(Object(l.a)({className:"posts-page"},a),{},{children:[Object(r.jsxs)(s.a,{children:[Object(r.jsx)("title",{children:"All Posts - My Posts"}),Object(r.jsx)("meta",{name:"description",content:"List of all posts with comments"})]}),Object(r.jsx)(P,{}),t.filter((function(e){var t,n;return""===o||null==(null===(t=e.user)||void 0===t?void 0:t.name)||(null===(n=e.user.name.toLowerCase())||void 0===n?void 0:n.indexOf(o))>-1})).map((function(e){return Object(r.jsx)(u.b,{className:"post-link",to:"../post/".concat(e.id),children:Object(r.jsx)(y,{post:e})},e.id)}))]}))}}]),n}(o.a.Component)),"PostsPage")),F=function(e){if("object"!==typeof e||null===e)return!1;if(!e.hasOwnProperty("postId"))return!1;if(!e.hasOwnProperty("id"))return!1;if(!e.hasOwnProperty("name"))return!1;if(!e.hasOwnProperty("email"))return!1;if(!e.hasOwnProperty("body"))return!1;var t=e;return"number"===typeof t.postId&&null!=t.postId&&("number"===typeof t.id&&null!=t.id&&("string"===typeof t.name&&null!=t.name&&("string"===typeof t.email&&null!=t.email&&("string"===typeof t.body&&null!=t.body))))},U=function(e){if("object"!==typeof e||null===e)return!1;if(!e.hasOwnProperty("id"))return!1;if(!e.hasOwnProperty("name"))return!1;var t=e;return"number"===typeof t.id&&null!=t.id&&("string"===typeof t.name&&null!=t.name)},M=function(e){if("object"!==typeof e||null===e)return!1;if(!e.hasOwnProperty("userId"))return!1;if(!e.hasOwnProperty("id"))return!1;if(!e.hasOwnProperty("title"))return!1;if(!e.hasOwnProperty("body"))return!1;var t=e;return"number"===typeof t.userId&&null!=t.userId&&("number"===typeof t.id&&null!=t.id&&("string"===typeof t.title&&null!=t.title&&("string"===typeof t.body&&null!=t.body)))},A=function(){return fetch("https://jsonplaceholder.typicode.com/users").then((function(e){return e.text()})).then((function(e){var t;try{t=JSON.parse(e)}catch(n){throw new Error("Unexpected data received from users endpoint")}if(!Array.isArray(t))throw new Error("Expected users endpoint to return an array");return t.reduce((function(e,t){if(!U(t))throw new Error("Unexpected data received from users endpoint");var n=t;return e[n.id]={id:n.id,name:n.name},e}),{})}))},J=function(e){return fetch("https://jsonplaceholder.typicode.com/users/".concat(e)).then((function(e){return e.text()})).then((function(e){var t;try{t=JSON.parse(e)}catch(r){new Error("Unexpected data received from user endpoint")}if(!U(t))throw new Error("Unexpected data received from user endpoint");var n=t;return{id:n.id,name:n.name}}))},L=function(e){return void 0===e||null===e?Promise.reject(new Error("PostId must be provided")):fetch("https://jsonplaceholder.typicode.com/posts/".concat(e,"/comments")).then((function(e){return e.text()})).then((function(t){var n;try{n=JSON.parse(t)}catch(r){throw new Error("Unexpected data received from comment endpoint")}if(!Array.isArray(n))throw new Error("Expected comments endpoint to return an array");return n.map((function(t){if(!F(t))throw new Error("Unexpected data received from comment endpoint");if(t.postId!==e)throw new Error("Expected candidate postId to equal requested postId");return{id:t.id,name:t.name,email:t.email,body:t.body}}))}))},B=function(){return fetch("https://jsonplaceholder.typicode.com/comments").then((function(e){return e.text()})).then((function(e){var t=JSON.parse(e);if(!Array.isArray(t))throw new Error("Expected comments endpoint to return an array");return t.reduce((function(e,t){var n;if(!F(t))throw new Error("Unexpected data received from comment endpoint");var r=null!==(n=e[t.postId])&&void 0!==n?n:[];return r.push({id:t.id,name:t.name,email:t.email,body:t.body}),e[t.postId]=r,e}),{})}))},_=/^[1-9][0-9]*$/,q=function(e){return"".concat(Math.round(1e5*Math.random()),"|").concat(Date.now(),"|").concat(null!==e&&void 0!==e?e:"")},G=function(e){Object(g.a)(n,e);var t=Object(N.a)(n);function n(e){var r;return Object(w.a)(this,n),(r=t.call(this,e))._provideDataToken=void 0,r.provideDataGenerator=function(e){return function(t){e===r._provideDataToken&&(r.setState({data:t}),r._provideDataToken=void 0)}},r.state={data:null,dataFunction:e.dataFunction,dataId:e.dataId},r}return Object(T.a)(n,[{key:"componentDidMount",value:function(){this.getData(this.props.dataId)}},{key:"componentDidUpdate",value:function(e,t){this.state.dataId===t.dataId&&this.state.dataFunction===t.dataFunction||this.getData(this.props.dataId)}},{key:"getData",value:function(e){this._provideDataToken=q(String(e)),this.props.dataFunction(this.provideDataGenerator(this._provideDataToken),e)}},{key:"componentWillUnmount",value:function(){this._provideDataToken=q("unmounting")}},{key:"render",value:function(){return"function"===typeof this.props.children?this.props.children(this.state.data):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.dataId!==t.dataId||e.dataFunction!==t.dataFunction?{data:null,dataId:e.dataId,dataFunction:e.dataFunction}:null}}]),n}(o.a.Component),W=function(e){return Object(r.jsx)(h,{componentName:"withData",children:function(){return Object(r.jsx)(G,Object(l.a)({},e))}})},H=function(e,t){var n;return null!==(n=e&&("error"===e.type?e.error:e.data&&t(e.data)))&&void 0!==n?n:"Loading..."};var $=function(){return Object(r.jsx)(j,{propsMessage:"Hello from",children:Object(r.jsx)(u.a,{children:Object(r.jsx)(C,{children:Object(r.jsx)(s.b,{children:Object(r.jsx)("div",{className:"App",children:Object(r.jsxs)(d.d,{children:[Object(r.jsx)(d.b,{path:"/posts",render:function(e){return Object(r.jsx)(W,{dataId:void 0,dataFunction:function(e){Promise.all([A(),B(),fetch("https://jsonplaceholder.typicode.com/posts").then((function(e){return e.text()})).then((function(e){var t;try{t=JSON.parse(e)}catch(n){throw new Error("Unexpected data received from posts endpoint")}if(!Array.isArray(t)||!t.every(M))throw new Error("Unexpected data received from posts endpoint");return t}))]).then((function(e){return e[2].map((function(t){var n,r=e[0],a=e[1],o=r[t.userId];if(!o)throw new Error("Couldn't retrieve user for post");return{id:t.id,title:t.title,body:t.body,comments:null!==(n=a[t.id])&&void 0!==n?n:[],user:o}}))})).then((function(t){return e({type:"success",data:t})}),(function(t){return e({type:"error",error:"Error retrieving posts"})}))},children:function(e){return H(e,(function(e){return Object(r.jsx)(D,{posts:e})}))}})}}),Object(r.jsx)(d.b,{path:"/post/:postId",render:function(e){var t=e.match.params.postId;return Object(r.jsx)(W,{dataId:t,dataFunction:function(e,t){var n;(n=t,_.test(n))?function(e){return Promise.all([fetch("https://jsonplaceholder.typicode.com/posts/".concat(e)).then((function(e){return e.text()})).then((function(e){var t;try{t=JSON.parse(e)}catch(r){throw new Error("Unexpected data received from post endpoint")}if(!M(t))throw new Error("Unexpected data received from post endpoint");var n=t;return Promise.all([n,J(n.userId)])})),L(e)]).then((function(e){var t=e[0][0],n=e[0][1],r=e[1];return{id:t.id,title:t.title,body:t.body,comments:r,user:n}}))}(parseInt(t)).then((function(t){return e({type:"success",data:t})}),(function(t){return e({type:"error",error:"Error retrieving the requested post"})})):e({type:"error",error:"Invalid post number"})},children:function(e){return H(e,(function(e){return Object(r.jsx)(x,{post:e})}))}})}}),Object(r.jsx)(d.b,{children:Object(r.jsx)(d.a,{to:"/posts"})})]})})})})})})},z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,44)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),o(e),c(e)}))};i.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)($,{})}),document.getElementById("root")),z()}},[[43,1,2]]]);
//# sourceMappingURL=main.fbfdea83.chunk.js.map